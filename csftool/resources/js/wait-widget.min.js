!function(a){var b=function(a,b){a.items_available.indexOf(b)<0&&(a.items_to_watch.push(b),a.dialog&&a.showDialog())},c=function(c,d){var e=c;a.each(d,function(a){b(e,d[a])})},d={autoOpen:!1,center_on:"#csftool-content",draggable:!1,height:200,modal:!1,resizable:!1,width:200},e={_listeners_:{},auto_stop:!1,dialog:null,initialized:!1,initial_class:"nowait",isactive:!1,items_available:[],items_to_watch:[],supported_listeners:["allItemsAvailable","itemIsAvailable","onStart","onStop"],widget_anchor:"body",allItemsAvailable:function(){return 0===a(this.items_available).not(this.items_to_watch).length&&0===a(this.items_to_watch).not(this.items_available).length},available:function(a){var b=this.items_available.indexOf(a);b<0&&(this.items_available.push(a),"itemIsAvailable"in this._listeners_&&this._listeners_.itemIsAvailable("itemIsAvailable",a),this.allItemsAvailable()&&(this.auto_stop&&this.stop(),"allItemsAvailable"in this._listeners_&&this._listeners_.allItemsAvailable("allItemsAvailable",this.items_available)))},bind:function(a,b){this.supported_listeners.indexOf(a)>=0&&(this._listeners_[a]=b)},createDialog:function(b){var c=this.mergeDialogOptions(b,this.dialog_options);this.dialog=a(this.widget_anchor).CsfToolSpinnerDialog(c),this.items_to_watch.length>0&&this.dialog.open()},hideDialog:function(){null!=this.dialog&&this.dialog.isopen&&this.dialog.close()},init:function(a){return this.dialog_options=this.mergeDialogOptions(a,d),this.initialized=!0,this},isavailable:function(a){return this.items_available.indexOf(a)>-1},mergeDialogOptions:function(b,c){var d=a.extend({},c);if("undefined"!=typeof b){var e=["center_on","height","width"];a.each(b,function(a,b){e.indexOf(a)>=0&&(d[a]=b)})}return d},showDialog:function(){null==this.dialog||this.dialog.isopen||this.dialog.open()},start:function(){var a=null;arguments.length>0&&(a=arguments[0]),arguments.length>1?this.auto_stop=arguments[1]:this.auto_stop=!1,this.items_available=[],this.items_to_watch=[],this.isactive=!0,a&&this.waitFor(a),"onStart"in this._listeners_&&this._listeners_.onStart("onStart",this.items_to_watch),null!=this.dialog&&this.showDialog()},stop:function(){if(null!=this.dialog){var a=!1;1==arguments.length&&(a=arguments[0]),a&&this.dialog.isopen&&this.hideDialog()}this.isactive=!1,"onStop"in this._listeners_&&this._listeners_.onStop("onStop",this.items_available)},waitFor:function(d){this.isactive?"string"===a.type(d)?b(this,d):c(this,d):"string"===a.type(d)?this.start([d]):this.start(d)},waiting:function(){return a(this.items_to_watch).not(this.items_available).length>0}};a.fn.CsfToolWaitWidget=function(b){var c=this.get(0),d=a.extend({},e);if("undefined"!=typeof c)if(a(c).is("body"))d.widget_anchor="body";else{if("string"!=typeof c.id)throw'DOM Element used to create an instance of CsfToolWaitWidget must have a unique id or be the "body" element.';d.widget_anchor="#"+c.id}return"undefined"!=typeof b&&d.createDialog(b),d}}(jQuery);